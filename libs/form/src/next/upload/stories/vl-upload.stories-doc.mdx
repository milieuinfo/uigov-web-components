import { ArgTypes, Canvas } from '@storybook/addon-docs';
import * as VlUploadStories from './vl-upload.stories';
import FormControlPublicMethods from '../../form-control/stories/form-control.public-methods-doc.mdx'

# Upload - next

Gebruik de `upload-next` component om één of meerdere bestanden te selecteren of te slepen naar het upload-veld.

Zie het [form demo](/docs/applicatief-voorbeelden-form-demo--documentatie) voorbeeld voor het gebruik binnen een form.

Dit component is de volgende versie van de [vl-upload](/docs/components-upload--documentatie) component, we raden aan op termijn deze versie te gebruiken.

## Voorbeeld

```js
import { VlUploadComponent } from '@domg-wc/form/next/upload';
```

```html
<vl-upload-next></vl-upload-next>
```

<Canvas of={VlUploadStories.UploadDefault}/>

## Configuratie

<ArgTypes of={VlUploadStories.UploadDefault}/>

## Publieke methodes

De volgende publieke methodes zijn beschikbaar op het `VlUploadComponent`:

<FormControlPublicMethods />

### getFiles(): DropzoneFile[]

Geeft een lijst van geaccepteerde bestanden terug.

### addFile(file: File): void

Handmatig bestand toevoegen aan de lijst van opgeladen bestanden zonder achterliggende upload

### upload(url?: string): void

Handmatig de upload aanroepen. Indien een url gegeven is, laad op naar die url.

### on(event: string, callback: (...args: unknown[]) => void)

Event listener toevoegen aan de Dropzone instantie van het upload component.

### off(event: string, callback: (...args: unknown[]) => void)

Event listener verwijderen van de Dropzone instantie van het upload component.

## Validatie

De component gebruikt achterliggend de [Dropzone](https://www.dropzonejs.com/) library.

Dropzone genereert achterliggend ook fouten, typisch wanneer er een bestand te veel is toegevoegd of het bestand te groot is.
Deze fouten worden getoond in de preview van het toegevoegde bestand en tellen mee in de validatie van het formulier.

Om deze functionaliteit te bekomen wordt er een `dropzoneValidator` gebruikt die overeenkomt met de `customError` [ValidityState](https://developer.mozilla.org/en-US/docs/Web/API/ValidityState) key.
Via de `customError` ValidityState key kan je een error message linken aan de `dropzoneValidator`.

## Toevoegen van bestanden

Naast het slepen van bestanden, kan de gebruiker ook één of meerdere bestanden uploaden door op de link in het upload-veld te klikken en de bestanden
selecteren in het bestandsmenu. Tenslotte is ook het ook mogelijk bestanden programmatorisch toe te voegen via de `addFile()` methode.

### Duplicaat detectie

Het is mogelijk om duplicaten van eenzelfde bestand te vermijden met het `disallow-duplicates` attribuut. Achterliggend
wordt er gecontroleerd op ofwel bestandsnaam en aantal bytes, of wordt een hex string vergeleken met eerder toegevoegde
bestanden. In dat geval worden de duplicaten meteen verwijderd.

Wanneer een duplicaat wordt verwijderd kan je luisteren naar het `duplicateRemoved` event om de gebruiker te informeren
dat bestanden werden verwijderd wegens duplicaat detectie.

### Content Security Policy

De `vl-upload` component maakt gebruik van de [Dropzone](https://www.dropzonejs.com/) library. Deze library maakt gebruik van inline styles. Deze inline styles worden niet toegelaten in een strikte [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP) policy.
Deze inline styles zijn echter niet nodig voor de werking van de `vl-upload` component.

## Referenties

### Dropzone

[Documentatie Dropzone](https://www.dropzonejs.com/#configuration-options)

### Digitaal Vlaanderen

[Documentatie Digitaal Vlaanderen - Upload](https://overheid.vlaanderen.be/webuniversum/v3/documentation/forms/vl-ui-upload)

### Legacy Documentatie

[Legacy Storybook - Upload](https://webcomponenten.omgeving.vlaanderen.be/storybook/?path=/docs/native-elements-vl-upload--default)

[Legacy Documentatie - Upload](https://webcomponenten.omgeving.vlaanderen.be/doc/VlUpload.html)

[Legacy Demo - Upload](https://webcomponenten.omgeving.vlaanderen.be/demo/vl-upload.html)
